(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6122:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,8173,23)),Promise.resolve().then(r.t.bind(r,231,23)),Promise.resolve().then(r.t.bind(r,6612,23)),Promise.resolve().then(r.bind(r,5805)),Promise.resolve().then(r.bind(r,7374)),Promise.resolve().then(r.t.bind(r,2487,23)),Promise.resolve().then(r.bind(r,3905))},102:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r(7437),n=r(2265),a=r(391),o=r.n(a);let l=e=>{let{message:t,type:r="error",onClose:a}=e,[l,i]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e;return l||(e=setTimeout(()=>{null==a||a()},5e3)),()=>{e&&clearTimeout(e)}},[l,a]),(0,s.jsx)("div",{className:"".concat(o()["alert-message"]," ").concat(o()[r]),onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:t})}},5805:(e,t,r)=>{"use strict";r.d(t,{MessageProvider:()=>o});var s=r(7437),n=r(2265);let a=(0,n.createContext)({message:{},setMessage:()=>{}}),o=e=>{let{children:t}=e,[r,o]=(0,n.useState)(null);return(0,s.jsx)(a.Provider,{value:{message:r,setMessage:o},children:t})}},7374:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var s=r(7437),n=r(5781),a=r.n(n),o=r(7138),l=r(7657),i=r(5169);let c=()=>{let e=(0,l.T)(),{isAuthenticated:t,user:r}=(0,l.C)(e=>e.auth);return(0,s.jsxs)("header",{className:a().header,children:[(0,s.jsx)("div",{className:a().logo,children:(0,s.jsx)(o.default,{href:"/",children:"Naru's blog"})}),(0,s.jsx)("nav",{className:a().nav,children:(0,s.jsx)("ul",{children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("li",{children:null==r?void 0:r.username}),(0,s.jsx)("li",{children:(0,s.jsx)("button",{type:"button",className:a()["btn-primary"],onClick:function(){e((0,i.w7)())},children:"Sign Out"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("li",{children:(0,s.jsx)(o.default,{href:"/signup",className:a()["btn-primary"],children:"Sign Up"})}),(0,s.jsx)("li",{children:(0,s.jsx)(o.default,{href:"/signin",className:a()["btn-secondary"],children:"Sign In"})})]})})})]})}},3905:(e,t,r)=>{"use strict";r.d(t,{default:()=>D});var s=r(7437),n=r(2265),a=r(7928),o=r.n(a),l=r(1233),i=r.n(l);let c=e=>{let{isOpen:t,onClose:r,Component:n,componentProps:a}=e;return t?(0,s.jsx)("div",{className:i()["modal-overlay"],children:(0,s.jsxs)("div",{className:i()["modal-content"],children:[(0,s.jsx)("button",{className:i()["close-button"],onClick:r,children:"X"}),(0,s.jsx)(n,{...a||{}})]})}):null};var d=r(545),u=r.n(d),p=r(9343),_=r(7753),m=r(9400),h=r(9365),g=r(102);let v=e=>{let{onClose:t}=e,{register:r,handleSubmit:a,formState:{errors:o},reset:l}=(0,p.cI)({resolver:(0,_.X)(m.$2)}),[i,c]=(0,n.useState)(""),[d,v]=(0,n.useState)(!1),x=async e=>{try{c(""),v(!1);let r=await h.Z.post("/categories",e);console.log(r.data),t()}catch(e){c("카테고리 생성에 실패했습니다. 다시 시도해 주세요."),v(!0),console.error(e)}};return(0,n.useEffect)(()=>{l({name:""})},[t,l]),(0,s.jsxs)(s.Fragment,{children:[d&&i&&(0,s.jsx)(g.Z,{message:i,type:"error",onClose:()=>v(!1)}),(0,s.jsxs)("form",{onSubmit:a(x),children:[(0,s.jsx)("input",{type:"text",id:"name",...r("name"),className:u()["category-name__input"]}),o.name&&(0,s.jsx)("p",{className:u()["error-message"],children:o.name.message}),(0,s.jsx)("button",{type:"submit",children:"생성하기"})]})]})};var x=r(3145),y=r.n(x),j=r(7657),b=r(8485),f=r(6875),C=r.n(f),N=r(2649),P=r(8527),I=r.n(P),S=r(3415);let w=()=>{let{post:e}=(0,j.C)(e=>e.post),{register:t,watch:r}=(0,p.cI)({resolver:(0,_.X)(m.Rj),defaultValues:{id:null==e?void 0:e.id,title:null==e?void 0:e.title,content:null==e?void 0:e.content,categoryId:null==e?void 0:e.categoryId}}),a=(0,j.C)(S.ne),[o,l]=(0,n.useState)(""),[i,c]=(0,n.useState)(!1),{user:d}=(0,j.C)(e=>e.auth),u=(0,n.useMemo)(()=>(null==d?void 0:d.role)==="OWNER",[d]),h=(0,n.useRef)(null);(0,n.useEffect)(()=>{try{var e;return h.current=new b.K({webSocketFactory:()=>new(C())("http://localhost:8080/ws"),reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3}),h.current.connectHeaders={Authorization:"Bearer ".concat(N.Z.get("NID_AUTH"))},h.current.onConnect=e=>{var t;console.log("Connected: "+e),null===(t=h.current)||void 0===t||t.subscribe("/topic/posts",e=>{console.log("Received message: ",e.body)})},h.current.onStompError=e=>{console.error("Broker reported error: "+e.headers.message),console.error("Additional details: "+e.body),l("게시글 수정에 실패했습니다. 다시 시도해 주세요.")},null===(e=h.current)||void 0===e||e.activate(),()=>{var e;null===(e=h.current)||void 0===e||e.deactivate()}}catch(e){console.error(e)}},[]);let v="post_draft_".concat(null==e?void 0:e.id),x=(0,n.useMemo)(()=>I()(t=>{try{var r;null===(r=h.current)||void 0===r||r.publish({destination:"/app/post",body:JSON.stringify({id:null==e?void 0:e.id,title:t.title,content:t.content,categoryId:t.categoryId})}),localStorage.removeItem(v)}catch(e){console.error(e),l("게시글 전송에 실패했습니다."),c(!0)}},1e3),[null==e?void 0:e.id]);return(0,n.useEffect)(()=>{let e=r(e=>{localStorage.setItem(v,JSON.stringify(e)),x(e)});return()=>{e.unsubscribe(),x.cancel()}},[r,x,v]),(0,n.useEffect)(()=>{let t=r(t=>{try{var r;null===(r=h.current)||void 0===r||r.publish({destination:"/app/post",body:JSON.stringify({id:null==e?void 0:e.id,title:t.title,content:t.content,categoryId:t.categoryId})})}catch(e){console.error(e),l("게시글 전송에 실패했습니다."),c(!0)}});return()=>t.unsubscribe()},[r,null==e?void 0:e.id]),(0,n.useEffect)(()=>()=>{var e,t;let r=localStorage.getItem(v);if(r)try{null===(t=h.current)||void 0===t||t.publish({destination:"/app/post",body:r}),localStorage.removeItem(v)}catch(e){console.error(e),l("게시글 전송에 실패했습니다."),c(!0)}null===(e=h.current)||void 0===e||e.deactivate()},[v]),(0,s.jsxs)(s.Fragment,{children:[i&&o&&(0,s.jsx)(g.Z,{message:o,type:"error",onClose:()=>c(!1)}),(0,s.jsxs)("form",{className:y()["post-edit__form"],children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"title",children:"제목"}),u?(0,s.jsx)("input",{type:"text",id:"title",...t("title"),className:y().post__input}):(0,s.jsx)("span",{children:null==e?void 0:e.title})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"category",children:"카테고리"}),u?(0,s.jsxs)("select",{id:"category",...t("categoryId"),className:y().post__input,children:[(0,s.jsx)("option",{value:"",children:"카테고리 선택"}),a.map(e=>(0,s.jsx)("option",{value:"".concat(e.id),children:e.name},e.id))]}):(0,s.jsx)("span",{children:null==e?void 0:e.categoryId})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"author",children:"작성자"}),(0,s.jsx)("span",{id:"author",className:y()["post-author"],children:null==e?void 0:e.author})]}),(0,s.jsx)("hr",{}),(0,s.jsx)("label",{htmlFor:"author",className:"sr-only",children:"내용"}),u?(0,s.jsx)("textarea",{id:"content",...t("content"),className:y().post__textarea}):(0,s.jsx)("span",{children:null==e?void 0:e.content})]})]})};var M=r(9885),E=r.n(M);let Z=e=>{let{slides:t}=e,r=(0,n.useRef)(null),a=(0,n.useRef)(!1),o=(0,n.useRef)(0),l=(0,n.useRef)(0);return(0,s.jsx)("li",{className:E().carousel,children:(0,s.jsx)("div",{ref:r,className:E().carouselTrack,onMouseDown:e=>{var t,s;a.current=!0,o.current=e.pageX-((null===(t=r.current)||void 0===t?void 0:t.offsetLeft)||0),l.current=(null===(s=r.current)||void 0===s?void 0:s.scrollLeft)||0,r.current&&(r.current.style.cursor="grabbing")},onMouseLeave:()=>{a.current=!1,r.current&&(r.current.style.cursor="grab")},onMouseUp:e=>{e.stopPropagation(),a.current=!1,r.current&&(r.current.style.cursor="grab")},onMouseMove:e=>{var t;if(!a.current)return;e.preventDefault();let s=(e.pageX-((null===(t=r.current)||void 0===t?void 0:t.offsetLeft)||0)-o.current)*1.5;r.current&&(r.current.scrollLeft=l.current-s)},children:t.map((e,t)=>(0,s.jsx)("div",{className:E().carouselSlide,style:{width:"".concat(25,"%")},children:e},t))})})};var R=r(5804),T=r.n(R),L=r(924);let k=e=>{let{id:t,author:r,title:a,content:o,categoryId:l,comments:i}=e,c=(0,j.T)(),d=(0,n.useRef)(!1),u=(0,n.useRef)(0);return(0,s.jsxs)("div",{className:T().postCard,onClick:()=>{d.current||c((0,L.Cd)({id:t,title:a,author:r,content:o,categoryId:l,comments:i}))},onMouseDown:e=>{d.current=!1,u.current=e.pageX},onMouseMove:e=>{Math.abs(e.pageX-u.current)>3&&(d.current=!0)},children:[(0,s.jsx)("h2",{className:T().postCardTitle,children:a}),(0,s.jsxs)("p",{className:T().postCardAuthor,children:[(0,s.jsx)("strong",{children:"작성자:"})," ",r]})]})};var A=r(4612),q=r.n(A);let B=e=>{let{postList:t}=e;return t.length>0?(0,s.jsx)("ul",{className:q()["list-container"],children:(0,s.jsx)(Z,{slides:t.map(e=>(0,s.jsx)(k,{...e},e.id))})}):null},F=e=>{let{user:t}=(0,j.C)(e=>e.auth);return(0,s.jsxs)("li",{className:u().categoryItem,children:[(0,s.jsxs)("div",{className:u().categoryTitleWrapper,children:[(0,s.jsx)("span",{className:u().categoryTitle,children:e.name})," ",(null==t?void 0:t.role)==="OWNER"?(0,s.jsx)("button",{type:"button",className:"",children:"수정하기"}):null]}),(0,s.jsx)(B,{postList:e.posts})]})},O=()=>{let e=(0,j.T)(),{categoryList:t}=(0,j.C)(e=>e.category);return(0,n.useEffect)(()=>{h.Z.get("/categories").then(t=>{e((0,S.BG)(t.data))})},[]),t.length>0?(0,s.jsx)("ul",{className:u()["category-list"],children:t.map(e=>(0,s.jsx)(F,{...e},e.id))}):null},D=()=>{let{user:e}=(0,j.C)(e=>e.auth),[t,r]=(0,n.useState)(!1),[a,l]=(0,n.useState)(!1),i=(0,j.T)(),{post:d}=(0,j.C)(e=>e.post);(0,n.useEffect)(()=>{d&&_()},[d]);let u=()=>{r(!0)},p=async()=>{try{let{id:e,username:t,title:r,content:s,categoryId:n,comments:a}=(await h.Z.post("/posts")).data;i((0,L.Cd)({id:e,author:t,title:r,content:s,categoryId:n,comments:a})),_()}catch(e){console.error(e)}},_=()=>{l(!0)},{postList:m}=(0,j.C)(e=>e.post);return(0,n.useEffect)(()=>{h.Z.get("/posts").then(e=>{i((0,L.nC)(e.data))})},[]),(0,s.jsxs)("main",{className:o()["landing-main"],children:[(0,s.jsx)(c,{isOpen:t,onClose:()=>{r(!1)},Component:v,componentProps:{categoryFormInputs:{name:""},onClose:()=>r(!1)}}),(0,s.jsx)(c,{isOpen:a,onClose:()=>{l(!1)},Component:w,componentProps:{onClose:()=>l(!1)}}),(null==e?void 0:e.role)==="OWNER"?(0,s.jsxs)("div",{className:o()["main-btn-container"],children:[(0,s.jsx)("button",{type:"button",onClick:()=>u(),className:o()["category-add-btn"],children:"카테고리 추가"}),(0,s.jsx)("button",{type:"button",onClick:()=>p(),className:o()["post-add-btn"],children:"게시글 생성"})]}):null,(0,s.jsx)(B,{postList:m}),(0,s.jsx)(O,{})]})}},9365:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let s=r(8472).Z.create({baseURL:"http://localhost:8080",headers:{"Content-Type":"application/json"},withCredentials:!0});s.interceptors.request.use(e=>e,e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>Promise.reject(e));let n=s},5169:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>i,w7:()=>l,zB:()=>o});var s=r(1116),n=r(2649);let a=(0,s.oM)({name:"auth",initialState:{isAuthenticated:!1,user:null},reducers:{signIn:(e,t)=>{e.isAuthenticated=!0,e.user=t.payload},signOut:e=>{e.isAuthenticated=!1,e.user=null,n.Z.remove("NID_AUTH")}}}),{signIn:o,signOut:l}=a.actions,i=a.reducer},3415:(e,t,r)=>{"use strict";r.d(t,{BG:()=>a,ZP:()=>o,ne:()=>n});let s=(0,r(1116).oM)({name:"post",initialState:{categoryList:[]},reducers:{setCategoryList:(e,t)=>{e.categoryList=t.payload}}}),n=e=>e.category.categoryList.map(e=>({id:e.id,name:e.name})),{setCategoryList:a}=s.actions,o=s.reducer},7657:(e,t,r)=>{"use strict";r.d(t,{C:()=>a,T:()=>n});var s=r(1444);let n=()=>(0,s.I0)(),a=s.v9},924:(e,t,r)=>{"use strict";r.d(t,{Cd:()=>a,ZP:()=>o,nC:()=>n});let s=(0,r(1116).oM)({name:"post",initialState:{postList:[],post:null},reducers:{setPostList:(e,t)=>{e.postList=t.payload},setPost:(e,t)=>{e.post=t.payload}}}),{setPostList:n,setPost:a}=s.actions,o=s.reducer},9400:(e,t,r)=>{"use strict";r.d(t,{$2:()=>o,Rj:()=>l,dm:()=>a,if:()=>n});var s=r(4245);let n=s.Ry().shape({username:s.Z_().required("Username is required"),email:s.Z_().email("Invalid email").required("Email is required"),password:s.Z_().min(6,"Password must be at least 6 characters").required("Password is required")}),a=s.Ry().shape({email:s.Z_().email("Invalid email").required("Email is required"),password:s.Z_().required("Password is required")}),o=s.Ry().shape({name:s.Z_().required("title is required")}),l=s.Ry().shape({id:s.Rx().nullable().default(null),title:s.Z_().nullable().default(null),content:s.Z_().nullable().default(null),categoryId:s.Rx().nullable().default(null)})},6612:e=>{e.exports={"landing-container":"page_landing-container__N9JoZ","landing-introduction":"page_landing-introduction__IBYmq","landing-introduction-btn-wrapper":"page_landing-introduction-btn-wrapper__uY1P6","landing-footer":"page_landing-footer__liBjb"}},391:e=>{e.exports={"alert-message":"Alert_alert-message__FffhX",slideIn:"Alert_slideIn__Uxwux",error:"Alert_error__sMv5d",success:"Alert_success__vQBXB",warning:"Alert_warning__6DDhO",info:"Alert_info__5QGDB"}},545:e=>{e.exports={"category-list":"Category_category-list__Wmxbw",categoryItem:"Category_categoryItem__akShq",categoryTitleWrapper:"Category_categoryTitleWrapper__b2c8O",categoryTitle:"Category_categoryTitle__blFwY"}},9885:e=>{e.exports={carousel:"Carousel_carousel__8hD3U",carouselTrack:"Carousel_carouselTrack__yqE_G",carouselSlide:"Carousel_carouselSlide__KClRd"}},5781:e=>{e.exports={header:"Header_header__7tWxr",logo:"Header_logo__H_YRH",nav:"Header_nav__uF1wP","btn-primary":"Header_btn-primary__rp56r","btn-secondary":"Header_btn-secondary__mUW_q"}},2487:e=>{e.exports={logo:"Logo_logo__tj16b"}},7928:e=>{e.exports={"main-btn-container":"Main_main-btn-container__ZpC6B","category-add-btn":"Main_category-add-btn__WwMDr","post-add-btn":"Main_post-add-btn__yGMCn","landing-main":"Main_landing-main__Wk_eY"}},1233:e=>{e.exports={"modal-overlay":"Modal_modal-overlay__PT944","modal-content":"Modal_modal-content__Z1jBB"}},5804:e=>{e.exports={postCard:"PostCard_postCard__1Rkoo",postCardTitle:"PostCard_postCardTitle__LVC_Z",postCardAuthor:"PostCard_postCardAuthor__dP8mU"}},3145:e=>{e.exports={editButton:"PostEditor_editButton__Ra9bo",editingArea:"PostEditor_editingArea___XEFk",saveButton:"PostEditor_saveButton__j79Iz","post-edit__form":"PostEditor_post-edit__form__DnFFC","post-author":"PostEditor_post-author__PXzO9"}},4612:e=>{e.exports={"list-container":"PostList_list-container__4pv2M"}}},e=>{var t=t=>e(e.s=t);e.O(0,[156,220,462,131,130,215,744],()=>t(6122)),_N_E=e.O()}]);